import{connect}from"\u0063\u006C\u006F\u0075\u0064\u0066\u006C\u0061\u0072\u0065\u003A\u0073\u006F\u0063\u006B\u0065\u0074\u0073";export default{async fetch(req,env){var _0xa2af9c=(202416^202423)+(120811^120810);const UUID=env['\u0055\u0055\u0049\u0044']||"78eb90648292-423b-0144-9909-7578504a".split("").reverse().join("");_0xa2af9c=(791097^791098)+(611199^611199);if(req['\u0068\u0065\u0061\u0064\u0065\u0072\u0073']['\u0067\u0065\u0074']("edargpU".split("").reverse().join(""))?.toLowerCase()==="\u0077\u0065\u0062\u0073\u006F\u0063\u006B\u0065\u0074"){const[client,ws]=Object['\u0076\u0061\u006C\u0075\u0065\u0073'](new WebSocketPair());ws['\u0061\u0063\u0063\u0065\u0070\u0074']();const u=new URL(req['\u0075\u0072\u006C']);if(u['\u0070\u0061\u0074\u0068\u006E\u0061\u006D\u0065']['\u0069\u006E\u0063\u006C\u0075\u0064\u0065\u0073']("F3%".split("").reverse().join(""))){var _0xd9989e=(851976^851983)+(214975^214975);const decoded=decodeURIComponent(u['\u0070\u0061\u0074\u0068\u006E\u0061\u006D\u0065']);_0xd9989e=(391125^391132)+(889004^888997);const queryIndex=decoded['\u0069\u006E\u0064\u0065\u0078\u004F\u0066']("\u003F");if(queryIndex!==-(735084^735085)){u['\u0073\u0065\u0061\u0072\u0063\u0068']=decoded['\u0073\u0075\u0062\u0073\u0074\u0072\u0069\u006E\u0067'](queryIndex);u['\u0070\u0061\u0074\u0068\u006E\u0061\u006D\u0065']=decoded['\u0073\u0075\u0062\u0073\u0074\u0072\u0069\u006E\u0067'](648633^648633,queryIndex);}}var _0x7e_0x4fa;const mode=u['\u0073\u0065\u0061\u0072\u0063\u0068\u0050\u0061\u0072\u0061\u006D\u0073']['\u0067\u0065\u0074']("\u006D\u006F\u0064\u0065")||"\u0061\u0075\u0074\u006F";_0x7e_0x4fa=(358131^358132)+(354891^354888);const s5Param=u['\u0073\u0065\u0061\u0072\u0063\u0068\u0050\u0061\u0072\u0061\u006D\u0073']['\u0067\u0065\u0074']("5s".split("").reverse().join(""));const proxyParam=u['\u0073\u0065\u0061\u0072\u0063\u0068\u0050\u0061\u0072\u0061\u006D\u0073']['\u0067\u0065\u0074']("\u0070\u0072\u006F\u0078\u0079\u0069\u0070");var _0x36e8a;const path=s5Param?s5Param:u['\u0070\u0061\u0074\u0068\u006E\u0061\u006D\u0065']['\u0073\u006C\u0069\u0063\u0065'](659444^659445);_0x36e8a=(953242^953241)+(455996^455999);var _0x58cf8b=(500465^500473)+(159938^159946);const socks5=path['\u0069\u006E\u0063\u006C\u0075\u0064\u0065\u0073']("\u0040")?(()=>{const[cred,server]=path['\u0073\u0070\u006C\u0069\u0074']("\u0040");const[user,pass]=cred['\u0073\u0070\u006C\u0069\u0074']("\u003A");const[host,port=263177^263602]=server['\u0073\u0070\u006C\u0069\u0074']("\u003A");return{"user":user,"pass":pass,'\u0068\u006F\u0073\u0074':host,"port":+port};})():null;_0x58cf8b=629835^629838;const PROXY_IP=proxyParam?String(proxyParam):null;var _0xaa61df=(610788^610787)+(848913^848913);const getOrder=()=>{if(mode==="\u0070\u0072\u006F\u0078\u0079")return["\u0064\u0069\u0072\u0065\u0063\u0074","yxorp".split("").reverse().join("")];if(mode!=="\u0061\u0075\u0074\u006F")return[mode];const order=[];const searchStr=u['\u0073\u0065\u0061\u0072\u0063\u0068']['\u0073\u006C\u0069\u0063\u0065'](450420^450421);for(const pair of searchStr['\u0073\u0070\u006C\u0069\u0074']("\u0026")){var _0x9dd8fa=(922610^922618)+(132992^132994);const key=pair['\u0073\u0070\u006C\u0069\u0074']("\u003D")[734221^734221];_0x9dd8fa=(694789^694791)+(925647^925645);if(key==="\u0064\u0069\u0072\u0065\u0063\u0074")order['\u0070\u0075\u0073\u0068']("tcerid".split("").reverse().join(""));else if(key==="5s".split("").reverse().join(""))order['\u0070\u0075\u0073\u0068']("\u0073\u0035");else if(key==="\u0070\u0072\u006F\u0078\u0079\u0069\u0070")order['\u0070\u0075\u0073\u0068']("yxorp".split("").reverse().join(""));}return order['\u006C\u0065\u006E\u0067\u0074\u0068']?order:["tcerid".split("").reverse().join("")];};_0xaa61df=(398780^398773)+(678927^678919);let remote=null,udpWriter=null,isDNS=false;const socks5Connect=async(targetHost,targetPort)=>{var _0xb6d=(662624^662626)+(365740^365743);const sock=connect({'\u0068\u006F\u0073\u0074\u006E\u0061\u006D\u0065':socks5['\u0068\u006F\u0073\u0074'],'\u0070\u006F\u0072\u0074':socks5['\u0070\u006F\u0072\u0074']});_0xb6d=794992^794996;await sock['\u006F\u0070\u0065\u006E\u0065\u0064'];const w=sock['\u0077\u0072\u0069\u0074\u0061\u0062\u006C\u0065']['\u0067\u0065\u0074\u0057\u0072\u0069\u0074\u0065\u0072']();const r=sock['\u0072\u0065\u0061\u0064\u0061\u0062\u006C\u0065']['\u0067\u0065\u0074\u0052\u0065\u0061\u0064\u0065\u0072']();await w['\u0077\u0072\u0069\u0074\u0065'](new Uint8Array([351198^351195,421079^421077,664624^664624,674449^674451]));const auth=(await r['\u0072\u0065\u0061\u0064']())['\u0076\u0061\u006C\u0075\u0065'];if(auth[805949^805948]===(407452^407454)&&socks5['\u0075\u0073\u0065\u0072']){var _0x5b11ba;const user=new TextEncoder()['\u0065\u006E\u0063\u006F\u0064\u0065'](socks5['\u0075\u0073\u0065\u0072']);_0x5b11ba="jjdndo".split("").reverse().join("");var _0x4a3db;const pass=new TextEncoder()['\u0065\u006E\u0063\u006F\u0064\u0065'](socks5['\u0070\u0061\u0073\u0073']);_0x4a3db=(270752^270761)+(247691^247688);await w['\u0077\u0072\u0069\u0074\u0065'](new Uint8Array([769447^769446,user['\u006C\u0065\u006E\u0067\u0074\u0068'],...user,pass['\u006C\u0065\u006E\u0067\u0074\u0068'],...pass]));await r['\u0072\u0065\u0061\u0064']();}const domain=new TextEncoder()['\u0065\u006E\u0063\u006F\u0064\u0065'](targetHost);await w['\u0077\u0072\u0069\u0074\u0065'](new Uint8Array([373248^373253,609687^609686,172511^172511,772896^772899,domain['\u006C\u0065\u006E\u0067\u0074\u0068'],...domain,targetPort>>(501626^501618),targetPort&(630853^630970)]));await r['\u0072\u0065\u0061\u0064']();w['\u0072\u0065\u006C\u0065\u0061\u0073\u0065\u004C\u006F\u0063\u006B']();r['\u0072\u0065\u006C\u0065\u0061\u0073\u0065\u004C\u006F\u0063\u006B']();return sock;};new ReadableStream({start(ctrl){ws['\u0061\u0064\u0064\u0045\u0076\u0065\u006E\u0074\u004C\u0069\u0073\u0074\u0065\u006E\u0065\u0072']("\u006D\u0065\u0073\u0073\u0061\u0067\u0065",e=>ctrl['\u0065\u006E\u0071\u0075\u0065\u0075\u0065'](e['\u0064\u0061\u0074\u0061']));ws['\u0061\u0064\u0064\u0045\u0076\u0065\u006E\u0074\u004C\u0069\u0073\u0074\u0065\u006E\u0065\u0072']("\u0063\u006C\u006F\u0073\u0065",()=>{remote?.close();ctrl['\u0063\u006C\u006F\u0073\u0065']();});ws['\u0061\u0064\u0064\u0045\u0076\u0065\u006E\u0074\u004C\u0069\u0073\u0074\u0065\u006E\u0065\u0072']("\u0065\u0072\u0072\u006F\u0072",()=>{remote?.close();ctrl['\u0065\u0072\u0072\u006F\u0072']();});const early=req['\u0068\u0065\u0061\u0064\u0065\u0072\u0073']['\u0067\u0065\u0074']("\u0073\u0065\u0063\u002D\u0077\u0065\u0062\u0073\u006F\u0063\u006B\u0065\u0074\u002D\u0070\u0072\u006F\u0074\u006F\u0063\u006F\u006C");if(early){try{ctrl['\u0065\u006E\u0071\u0075\u0065\u0075\u0065'](Uint8Array['\u0066\u0072\u006F\u006D'](atob(early['\u0072\u0065\u0070\u006C\u0061\u0063\u0065'](new RegExp('\u002D','\u0067'),"\u002B")['\u0072\u0065\u0070\u006C\u0061\u0063\u0065'](new RegExp('\u005F','\u0067'),"\u002F")),c=>c['\u0063\u0068\u0061\u0072\u0043\u006F\u0064\u0065\u0041\u0074'](803949^803949))['\u0062\u0075\u0066\u0066\u0065\u0072']);}catch{}}}})['\u0070\u0069\u0070\u0065\u0054\u006F'](new WritableStream({async write(data){if(isDNS)return udpWriter?.write(data);if(remote){const w=remote['\u0077\u0072\u0069\u0074\u0061\u0062\u006C\u0065']['\u0067\u0065\u0074\u0057\u0072\u0069\u0074\u0065\u0072']();await w['\u0077\u0072\u0069\u0074\u0065'](data);w['\u0072\u0065\u006C\u0065\u0061\u0073\u0065\u004C\u006F\u0063\u006B']();return;}if(data['\u0062\u0079\u0074\u0065\u004C\u0065\u006E\u0067\u0074\u0068']<(944976^944968))return;const uuidBytes=new Uint8Array(data['\u0073\u006C\u0069\u0063\u0065'](402451^402450,710326^710311));var _0x2gb=(615468^615461)+(948601^948607);const expectedUUID=UUID['\u0072\u0065\u0070\u006C\u0061\u0063\u0065'](new RegExp('\u002D','\u0067'),'');_0x2gb=(128356^128358)+(181445^181446);for(let i=202893^202893;i<(974484^974468);i++){if(uuidBytes[i]!==parseInt(expectedUUID['\u0073\u0075\u0062\u0073\u0074\u0072'](i*(622328^622330),519458^519456),755861^755845))return;}var _0x66e2b=(988423^988419)+(936147^936146);const view=new DataView(data);_0x66e2b=(654972^654971)+(706005^706007);const optLen=view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0038'](873733^873748);const cmd=view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0038']((429417^429435)+optLen);if(cmd!==(833487^833486)&&cmd!==(527061^527063))return;let pos=(993278^993261)+optLen;var _0xcb5a=(275063^275059)+(907314^907316);const port=view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0031\u0036'](pos);_0xcb5a=(921805^921806)+(465569^465574);const type=view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0038'](pos+(761495^761493));pos+=566691^566688;let addr='';if(type===(457451^457450)){addr=`${view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0038'](pos)}.${view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0038'](pos+(360006^360007))}.${view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0038'](pos+(971196^971198))}.${view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0038'](pos+(671353^671354))}`;pos+=739433^739437;}else if(type===(458514^458512)){const len=view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0038'](pos++);addr=new TextDecoder()['\u0064\u0065\u0063\u006F\u0064\u0065'](data['\u0073\u006C\u0069\u0063\u0065'](pos,pos+len));pos+=len;}else if(type===(250490^250489)){var _0x5479a;const ipv6=[];_0x5479a='\u0071\u0070\u0064\u0067\u006F\u0062';for(let i=157777^157777;i<(526057^526049);i++,pos+=932692^932694)ipv6['\u0070\u0075\u0073\u0068'](view['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0031\u0036'](pos)['\u0074\u006F\u0053\u0074\u0072\u0069\u006E\u0067'](175845^175861));addr=ipv6['\u006A\u006F\u0069\u006E']("\u003A");}else return;const header=new Uint8Array([data[296479^296479],657359^657359]);var _0xd66a3d=(320051^320052)+(127494^127495);const payload=data['\u0073\u006C\u0069\u0063\u0065'](pos);_0xd66a3d=(864328^864329)+(982446^982447);if(cmd===(614043^614041)){if(port!==(832330^832383))return;isDNS=!![];let sent=false;const{'\u0072\u0065\u0061\u0064\u0061\u0062\u006C\u0065':readable,"writable":writable}=new TransformStream({transform(chunk,ctrl){for(let i=961142^961142;i<chunk['\u0062\u0079\u0074\u0065\u004C\u0065\u006E\u0067\u0074\u0068'];){const len=new DataView(chunk['\u0073\u006C\u0069\u0063\u0065'](i,i+(332596^332598)))['\u0067\u0065\u0074\u0055\u0069\u006E\u0074\u0031\u0036'](450738^450738);ctrl['\u0065\u006E\u0071\u0075\u0065\u0075\u0065'](chunk['\u0073\u006C\u0069\u0063\u0065'](i+(545682^545680),i+(965110^965108)+len));i+=(734134^734132)+len;}}});readable['\u0070\u0069\u0070\u0065\u0054\u006F'](new WritableStream({async write(query){try{var _0xf92ffa=(498279^498276)+(239043^239040);const resp=await fetch("\u0068\u0074\u0074\u0070\u0073\u003A\u002F\u002F\u0031\u002E\u0031\u002E\u0031\u002E\u0031\u002F\u0064\u006E\u0073\u002D\u0071\u0075\u0065\u0072\u0079",{'\u006D\u0065\u0074\u0068\u006F\u0064':'POST',"headers":{"\u0063\u006F\u006E\u0074\u0065\u006E\u0074\u002D\u0074\u0079\u0070\u0065":"\u0061\u0070\u0070\u006C\u0069\u0063\u0061\u0074\u0069\u006F\u006E\u002F\u0064\u006E\u0073\u002D\u006D\u0065\u0073\u0073\u0061\u0067\u0065"},"body":query});_0xf92ffa=(941262^941260)+(758483^758482);if(ws['\u0072\u0065\u0061\u0064\u0079\u0053\u0074\u0061\u0074\u0065']===(878743^878742)){var _0xcb75cc;const result=new Uint8Array(await resp['\u0061\u0072\u0072\u0061\u0079\u0042\u0075\u0066\u0066\u0065\u0072']());_0xcb75cc=(878786^878785)+(235834^235826);ws['\u0073\u0065\u006E\u0064'](new Uint8Array([...(sent?[]:header),result['\u006C\u0065\u006E\u0067\u0074\u0068']>>(659643^659635),result['\u006C\u0065\u006E\u0067\u0074\u0068']&(944536^944487),...result]));sent=!![];}}catch{}}}));udpWriter=writable['\u0067\u0065\u0074\u0057\u0072\u0069\u0074\u0065\u0072']();return udpWriter['\u0077\u0072\u0069\u0074\u0065'](payload);}let sock=null;for(const method of getOrder()){try{if(method==="\u0064\u0069\u0072\u0065\u0063\u0074"){sock=connect({'\u0068\u006F\u0073\u0074\u006E\u0061\u006D\u0065':addr,'\u0070\u006F\u0072\u0074':port});await sock['\u006F\u0070\u0065\u006E\u0065\u0064'];break;}else if(method==="\u0073\u0035"&&socks5){sock=await socks5Connect(addr,port);break;}else if(method==="\u0070\u0072\u006F\u0078\u0079"&&PROXY_IP){const[ph,pp=port]=PROXY_IP['\u0073\u0070\u006C\u0069\u0074']("\u003A");sock=connect({'\u0068\u006F\u0073\u0074\u006E\u0061\u006D\u0065':ph,'\u0070\u006F\u0072\u0074':+pp||port});await sock['\u006F\u0070\u0065\u006E\u0065\u0064'];break;}}catch{}}if(!sock)return;remote=sock;const w=sock['\u0077\u0072\u0069\u0074\u0061\u0062\u006C\u0065']['\u0067\u0065\u0074\u0057\u0072\u0069\u0074\u0065\u0072']();await w['\u0077\u0072\u0069\u0074\u0065'](payload);w['\u0072\u0065\u006C\u0065\u0061\u0073\u0065\u004C\u006F\u0063\u006B']();let sent=false;sock['\u0072\u0065\u0061\u0064\u0061\u0062\u006C\u0065']['\u0070\u0069\u0070\u0065\u0054\u006F'](new WritableStream({write(chunk){if(ws['\u0072\u0065\u0061\u0064\u0079\u0053\u0074\u0061\u0074\u0065']===(998560^998561)){ws['\u0073\u0065\u006E\u0064'](sent?chunk:new Uint8Array([...header,...new Uint8Array(chunk)]));sent=!![];}},'\u0063\u006C\u006F\u0073\u0065':()=>ws['\u0072\u0065\u0061\u0064\u0079\u0053\u0074\u0061\u0074\u0065']===(675258^675259)&&ws['\u0063\u006C\u006F\u0073\u0065'](),'\u0061\u0062\u006F\u0072\u0074':()=>ws['\u0072\u0065\u0061\u0064\u0079\u0053\u0074\u0061\u0074\u0065']===(891036^891037)&&ws['\u0063\u006C\u006F\u0073\u0065']()}))['\u0063\u0061\u0074\u0063\u0068'](()=>{});}}))['\u0063\u0061\u0074\u0063\u0068'](()=>{});return new Response(null,{'\u0073\u0074\u0061\u0074\u0075\u0073':101,"webSocket":client});}const url=new URL(req['\u0075\u0072\u006C']);url['\u0068\u006F\u0073\u0074\u006E\u0061\u006D\u0065']="\u0065\u0078\u0061\u006D\u0070\u006C\u0065\u002E\u0063\u006F\u006D";return fetch(new Request(url,req));}};
